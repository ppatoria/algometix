<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Understand false sharing, how it degrades multi-core performance due to cache line contention, and techniques to minimize its impact."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://algometix.com/blog/cpu_cache/multicore-caching/false-sharing/"><meta property="og:site_name" content="Algometix"><meta property="og:title" content="False Sharing"><meta property="og:description" content="Understand false sharing, how it degrades multi-core performance due to cache line contention, and techniques to minimize its impact."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>False Sharing | Algometix</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://algometix.com/blog/cpu_cache/multicore-caching/false-sharing/><link rel=stylesheet href=/book.min.434035e7885c7f5d12818bd9f111cf1a0925c6fb78382667381c3d5eda3fb4f1.css integrity="sha256-Q0A154hcf10SgYvZ8RHPGgklxvt4OCZnOBw9Xto/tPE=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.a25bc5ab2697543c5bdda3aa980d691f1b1990393ccc13bfc90869dbf0c43b5b.js integrity="sha256-olvFqyaXVDxb3aOqmA1pHxsZkDk8zBO/yQhp2/DEO1s=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://algometix.com/blog/cpu_cache/multicore-caching/false-sharing/index.xml title=Algometix></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Algometix</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/blog/cpu_cache/>CPU Cache: Organization, Optimization and Challenges</a><ul><li><a href=/blog/cpu_cache/cache-optimization/>Cache Optimization Techniques</a><ul><li><a href=/blog/cpu_cache/cache-optimization/cache-optimization-focusing-on-data-alignment/>Data Alignment: Enhancing Contiguous Data Processing</a></li><li><a href=/blog/cpu_cache/cache-optimization/cache-optimization-through-prefetching/>Cache Prefetching: Enhancing Non-Contiguous Data Processing</a></li></ul></li><li><a href=/blog/cpu_cache/multicore-caching/>Multi-Core Caching Techniques</a><ul><li><a href=/blog/cpu_cache/multicore-caching/cache-hierarchy/>Cache Hierarchy and Sharing</a></li><li><a href=/blog/cpu_cache/multicore-caching/false-sharing/ class=active>False Sharing</a><ul><li><a href=/blog/cpu_cache/multicore-caching/false-sharing/false_sharing_adjacent_variables/>Impact of Adjacent Variable Modification</a></li><li><a href=/blog/cpu_cache/multicore-caching/false-sharing/partitioned_array_processing_and_false_sharing/>Impact of Adjacent Array Indices Modification</a></li></ul></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>False Sharing</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#what-is-false-sharing><strong>What is False Sharing?</strong></a></li><li><a href=#why-is-it-called-false-sharing><strong>Why is it Called &lsquo;False&rsquo; Sharing?</strong></a></li><li><a href=#when-does-false-sharing-happen><strong>When Does False Sharing Happen?</strong></a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h3 id=what-is-false-sharing><strong>What is False Sharing?</strong>
<a class=anchor href=#what-is-false-sharing>#</a></h3><p>False sharing occurs when multiple threads modify independent variables that reside in the same <strong>cache line</strong>, leading to unnecessary cache invalidation and performance degradation. This issue is often subtle and may not be immediately apparent in code, but it can significantly impact performance in multi-threaded programs.</p><h3 id=why-is-it-called-false-sharing><strong>Why is it Called &lsquo;False&rsquo; Sharing?</strong>
<a class=anchor href=#why-is-it-called-false-sharing>#</a></h3><ul><li><strong>What is shared?</strong> A cache line containing different variables used by multiple threads.</li><li><strong>Why &lsquo;false&rsquo;?</strong> The variables are <strong>not logically shared</strong> in terms of their use by different threads, but because they occupy the same cache line, any modification by one thread forces an update across multiple cores, causing inefficient cache invalidations and increased cache coherence traffic.</li></ul><h3 id=when-does-false-sharing-happen><strong>When Does False Sharing Happen?</strong>
<a class=anchor href=#when-does-false-sharing-happen>#</a></h3><p>False sharing occurs in <strong>multi-threaded programs</strong> due to the interaction between the following factors:</p><ul><li><strong>Adjacent variables</strong>: When threads modify independent variables stored adjacently in memory, they may end up in the <strong>same cache line</strong>.</li><li><strong>Cache coherence protocols</strong>: In systems with <strong>cache coherence protocols</strong> (e.g., MESI), even though each core has its own private cache (L1/L2), any modification in one core&rsquo;s cache must be reflected across all cores to maintain consistency. This forces <strong>unnecessary cache invalidations</strong> and <strong>cache misses</strong> when a variable in the same cache line is modified by different threads.</li><li><strong>Private L1/L2 caches</strong>: Although caches are private to each core, the <strong>cache coherence protocol</strong> ensures consistency across caches, triggering updates or invalidations in other coresâ€™ caches, which can degrade performance due to false sharing.</li></ul><p>This combination of <strong>adjacent data</strong> in the same cache line and the behavior of <strong>cache coherence protocols</strong> results in costly synchronization and performance degradation, even when the variables are independent.</p><hr></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#what-is-false-sharing><strong>What is False Sharing?</strong></a></li><li><a href=#why-is-it-called-false-sharing><strong>Why is it Called &lsquo;False&rsquo; Sharing?</strong></a></li><li><a href=#when-does-false-sharing-happen><strong>When Does False Sharing Happen?</strong></a></li></ul></li></ul></nav></div></aside></main></body></html>